(this["webpackJsonpmern-infrastructure"]=this["webpackJsonpmern-infrastructure"]||[]).push([[0],{33:function(e,t,n){},34:function(e,t,n){},36:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(22),a=n.n(s),i=n(12),l=(n(33),n(9)),o=n(2),u=(n(34),n(3)),j=n.n(u),d=n(5);function b(e){return h.apply(this,arguments)}function h(){return(h=Object(d.a)(j.a.mark((function e(t){var n,r,c,s,a,i=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"GET",r=i.length>2&&void 0!==i[2]?i[2]:null,c={method:n},r&&(c.headers={"Content-Type":"application/json"},c.body=JSON.stringify(r)),(s=y())&&(c.headers=c.headers||{},c.headers.Authorization="Bearer ".concat(s)),e.next=8,fetch(t,c);case 8:if(!(a=e.sent).ok){e.next=11;break}return e.abrupt("return",a.json());case 11:throw new Error("Bad Request");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O="/api/users";function m(e){return b(O,"POST",e)}function p(e){return b("".concat(O,"/login"),"POST",e)}function x(e){return f.apply(this,arguments)}function f(){return(f=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t);case 3:return n=e.sent,localStorage.setItem("token",n),e.abrupt("return",w());case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Invalid Sign Up");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p(t);case 3:return n=e.sent,localStorage.setItem("token",n),e.abrupt("return",w());case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Bad Credentials");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function N(){return b("".concat(O,"/check-token")).then((function(e){return new Date(e)}))}function y(){var e=localStorage.getItem("token");return e?JSON.parse(atob(e.split(".")[1])).exp<Date.now()/1e3?(localStorage.removeItem("token"),null):e:null}function w(){var e=y();return e?JSON.parse(atob(e.split(".")[1])).user:null}n(36);var C=n(11),k=n(15),S=n(0);function I(e){var t=e.setUser,n=Object(r.useState)({email:"",password:""}),c=Object(l.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)(""),o=Object(l.a)(i,2),u=o[0],b=o[1];function h(e){a(Object(k.a)(Object(k.a)({},s),{},Object(C.a)({},e.target.name,e.target.value))),b("")}function O(){return(O=Object(d.a)(j.a.mark((function e(n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,v(s);case 4:r=e.sent,t(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),b("Log In Failed - Try Again");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}return Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{className:"form-container",onSubmit:function(e){return O.apply(this,arguments)},children:Object(S.jsxs)("form",{autoComplete:"off",children:[Object(S.jsx)("label",{children:"Email"}),Object(S.jsx)("input",{type:"text",name:"email",value:s.email,onChange:h,required:!0}),Object(S.jsx)("label",{children:"Password"}),Object(S.jsx)("input",{type:"password",name:"password",value:s.password,onChange:h,required:!0}),Object(S.jsx)("button",{type:"submit",children:"LOG IN"})]})}),Object(S.jsxs)("p",{className:"error-message",children:["\xa0",u]})]})}var U=n(23),E=n(24),P=n(28),D=n(26),L=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(U.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={name:"",email:"",password:"",confirm:"",error:""},e.handleChange=function(t){e.setState(Object(C.a)({},t.target.name,t.target.value))},e.handleSubmit=function(){var t=Object(d.a)(j.a.mark((function t(n){var r,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,delete(r=Object(k.a)({},e.state)).error,delete r.confirm,t.next=7,x(r);case 7:c=t.sent,e.props.setUser(c),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.setState({error:"Sign Up Failed - Try Again"});case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(E.a)(n,[{key:"render",value:function(){var e=this.state.password!==this.state.confirm;return Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{className:"form-container",children:Object(S.jsxs)("form",{autoComplete:"off",onSubmit:this.handleSubmit,children:[Object(S.jsx)("label",{children:"Name"}),Object(S.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleChange,required:!0}),Object(S.jsx)("label",{children:"Email"}),Object(S.jsx)("input",{type:"email",name:"email",value:this.state.email,onChange:this.handleChange,required:!0}),Object(S.jsx)("label",{children:"Password"}),Object(S.jsx)("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleChange,required:!0}),Object(S.jsx)("label",{children:"Confirm"}),Object(S.jsx)("input",{type:"password",name:"confirm",value:this.state.confirm,onChange:this.handleChange,required:!0}),Object(S.jsx)("button",{type:"submit",disabled:e,children:"SIGN UP"})]})}),Object(S.jsxs)("p",{className:"error-message",children:["\xa0",this.state.error]})]})}}]),n}(r.Component);n(38);function A(){return Object(S.jsxs)("div",{className:"Logo",children:[Object(S.jsx)("div",{children:"SEI"}),Object(S.jsx)("div",{children:"CAFE"})]})}function T(e){var t=e.setUser,n=Object(r.useState)(!0),c=Object(l.a)(n,2),s=c[0],a=c[1];return Object(S.jsxs)("main",{className:"AuthPage",children:[Object(S.jsxs)("div",{children:[Object(S.jsx)(A,{}),Object(S.jsx)("h3",{onClick:function(){return a(!s)},children:s?"SIGN UP":"LOG IN"})]}),s?Object(S.jsx)(I,{setUser:t}):Object(S.jsx)(L,{setUser:t})]})}var F=n(27),q="/api/items";function R(){return b(q)}n(39),n(40),n(41);function G(e){var t=e.menuItem;return Object(S.jsxs)("div",{className:"MenuListItem",children:[Object(S.jsx)("div",{className:"emoji flex-ctr-ctr",children:t.emoji}),Object(S.jsx)("div",{className:"name",children:t.name}),Object(S.jsxs)("div",{className:"buy",children:[Object(S.jsxs)("span",{children:["$",t.price.toFixed(2)]}),Object(S.jsx)("button",{className:"btn-sm",onClick:function(){return console.log("clicked")},children:"ADD"})]})]})}function J(e){var t=e.menuItems.map((function(e){return Object(S.jsx)(G,{menuItem:e},e._id)}));return Object(S.jsx)("main",{className:"MenuList",children:t})}n(42);function B(e){var t=e.categories,n=e.activeCat,r=e.setActiveCat,c=t.map((function(e){return Object(S.jsx)("li",{className:e===n?"active":"",onClick:function(){return r(e)},children:e},e)}));return Object(S.jsx)("ul",{className:"CategoryList",children:c})}n(43),n(44);function M(e){var t=e.lineItem,n=e.isPaid;return Object(S.jsxs)("div",{className:"LineItem",children:[Object(S.jsx)("div",{className:"flex-ctr-ctr",children:t.item.emoji}),Object(S.jsxs)("div",{className:"flex-ctr-ctr flex-col",children:[Object(S.jsx)("span",{className:"align-ctr",children:t.item.name}),Object(S.jsx)("span",{children:t.item.price.toFixed(2)})]}),Object(S.jsxs)("div",{className:"qty",style:{justifyContent:n&&"center"},children:[!n&&Object(S.jsx)("button",{className:"btn-xs",onClick:function(){return alert("clicked")},children:"\u2212"}),Object(S.jsx)("span",{children:t.qty}),!n&&Object(S.jsx)("button",{className:"btn-xs",onClick:function(){return alert("clicked")},children:"+"})]}),Object(S.jsxs)("div",{className:"ext-price",children:["$",t.extPrice.toFixed(2)]})]})}function H(e){var t=e.order;if(!t)return null;var n=t.lineItems.map((function(e){return Object(S.jsx)(M,{lineItem:e,isPaid:t.isPaid},e._id)}));return Object(S.jsxs)("div",{className:"OrderDetail",children:[Object(S.jsxs)("div",{className:"section-heading",children:[t.isPaid?Object(S.jsxs)("span",{children:["ORDER ",Object(S.jsx)("span",{className:"smaller",children:t.orderId})]}):Object(S.jsx)("span",{children:"NEW ORDER"}),Object(S.jsx)("span",{children:new Date(t.updatedAt).toLocaleDateString()})]}),Object(S.jsx)("div",{className:"line-item-container flex-ctr-ctr flex-col scroll-y",children:n.length?Object(S.jsxs)(S.Fragment,{children:[n,Object(S.jsxs)("section",{className:"total",children:[t.isPaid?Object(S.jsx)("span",{className:"right",children:"TOTAL\xa0\xa0"}):Object(S.jsx)("button",{className:"btn-sm",onClick:function(){return alert("clicked")},disabled:!n.length,children:"CHECKOUT"}),Object(S.jsx)("span",{children:t.totalQty}),Object(S.jsxs)("span",{className:"right",children:["$",t.orderTotal.toFixed(2)]})]})]}):Object(S.jsx)("div",{className:"hungry",children:"Hungry?"})})]})}n(45);function $(e){var t=e.user,n=e.setUser;return Object(S.jsxs)("div",{className:"UserLogOut",children:[Object(S.jsx)("div",{children:t.name}),Object(S.jsx)("div",{className:"email",children:t.email}),Object(S.jsx)("button",{className:"btn-sm",onClick:function(){localStorage.removeItem("token"),n(null)},children:"LOG OUT"})]})}function W(e){var t=e.user,n=e.setUser,c=Object(r.useState)([]),s=Object(l.a)(c,2),a=s[0],o=s[1],u=Object(r.useState)(""),b=Object(l.a)(u,2),h=b[0],O=b[1],m=Object(r.useRef)([]);return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:t=e.sent,m.current=t.reduce((function(e,t){var n=t.category.name;return e.includes(n)?e:[].concat(Object(F.a)(e),[n])}),[]),o(t),O(m.current[0]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(S.jsxs)("main",{className:"NewOrderPage",children:[Object(S.jsxs)("aside",{children:[Object(S.jsx)(A,{}),Object(S.jsx)(B,{categories:m.current,activeCat:h,setActiveCat:O}),Object(S.jsx)(i.b,{to:"/orders",className:"button btn-sm",children:"PREVIOUS ORDERS"}),Object(S.jsx)($,{user:t,setUser:n})]}),Object(S.jsx)(J,{menuItems:a.filter((function(e){return e.category.name===h}))}),Object(S.jsx)(H,{})]})}function _(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:t=e.sent,console.log(new Date(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("h1",{children:"OrderHistoryPage"}),Object(S.jsx)("button",{onClick:function(){return e.apply(this,arguments)},children:"Check When My Login Expires"})]})}function z(){var e=Object(r.useState)(w()),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(S.jsx)("main",{className:"App",children:n?Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(o.d,{children:[Object(S.jsx)(o.b,{path:"/orders/new",children:Object(S.jsx)(W,{user:n,setUser:c})}),Object(S.jsx)(o.b,{path:"/orders",children:Object(S.jsx)(_,{})}),Object(S.jsx)(o.a,{to:"/orders"})]})}):Object(S.jsx)(T,{setUser:c})})}a.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(i.a,{children:Object(S.jsx)(z,{})})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.c739582c.chunk.js.map